¥
OD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\CharRange.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[ 
StructLayout 
( 

LayoutKind 
. 

Sequential '
)' (
]( )
struct		 

	CharRange		 
{

 
public 
int 
cpMin 
; 
public 
int 
cpMax 
; 
} 
} ‘
LD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\EnLink.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[		 
StructLayout		 
(		 

LayoutKind		 
.		 

Sequential		 '
)		' (
]		( )
class

 	
EnLink


 
{ 
public 
Nmhdr 
nmhdr 
; 
public 
int 
msg 
= 
$num 
; 
public 
IntPtr 
wParam 
= 
IntPtr %
.% &
Zero& *
;* +
public 
IntPtr 
lParam 
= 
IntPtr %
.% &
Zero& *
;* +
public## 
	CharRange## 
	charrange## "
;##" #
}$$ 
[)) 
StructLayout)) 
()) 

LayoutKind)) 
.)) 

Sequential)) '
)))' (
]))( )
public** 

class** 
EnLink64** 
{++ 
[// 	
	MarshalAs//	 
(// 
UnmanagedType//  
.//  !

ByValArray//! +
,//+ ,
	SizeConst//- 6
=//7 8
$num//9 ;
)//; <
]//< =
public00 
byte00 
[00 
]00 
contents00 
=00  
new00! $
byte00% )
[00) *
$num00* ,
]00, -
;00- .
}11 
}22 ö
QD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\FormatRange.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[

 
StructLayout

 
(

 

LayoutKind

 
.

 

Sequential

 '
)

' (
]

( )
struct 

FormatRange 
{ 
public 
IntPtr 
hdc 
; 
public 
IntPtr 
	hdcTarget 
;  
public 
Rect 
rc 
; 
public 
Rect 
rcPage 
; 
public$$ 
	CharRange$$ 
chrg$$ 
;$$ 
}%% 
}&& Ü
UD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\ImageParameters.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[		 
StructLayout		 
(		 

LayoutKind		 
.		 

Sequential		 '
)		' (
]		( )
struct

 

ImageParameters

 
{ 
public 
int 
xWidth 
; 
public 
int 
yHeight 
; 
public 
int 
ascent 
; 
public"" 
int"" 
type"" 
;"" 
['' 	
	MarshalAs''	 
('' 
UnmanagedType''  
.''  !
LPWStr''! '
)''' (
]''( )
public(( 
string(( 
pwszAlternateText(( '
;((' (
public-- 
IStream-- 
pIStream-- 
;--  
}.. 
}// éJ
SD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\NativeMethods.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
class 	
NativeMethods
 
{		 
internal

 
static

 
unsafe

 
EnLink

 %
ConvertFromENLINK64

& 9
(

9 :
EnLink64

: B
el64

C G
)

G H
{ 	
var 
el 
= 
new 
EnLink 
(  
)  !
;! "
fixed 
( 
byte 
* 
el64p 
=  
&! "
el64" &
.& '
contents' /
[/ 0
$num0 1
]1 2
)2 3
{ 
el 
. 
nmhdr 
= 
new 
Nmhdr $
($ %
)% &
;& '
el 
. 
	charrange 
= 
new "
	CharRange# ,
(, -
)- .
;. /
el 
. 
nmhdr 
. 
hwndFrom !
=" #
Marshal$ +
.+ ,

ReadIntPtr, 6
(6 7
(7 8
IntPtr8 >
)> ?
el64p? D
)D E
;E F
el 
. 
nmhdr 
. 
idFrom 
=  !
Marshal" )
.) *

ReadIntPtr* 4
(4 5
(5 6
IntPtr6 <
)< =
(= >
el64p> C
+D E
$numF G
)G H
)H I
;I J
el 
. 
nmhdr 
. 
code 
= 
Marshal  '
.' (
	ReadInt32( 1
(1 2
(2 3
IntPtr3 9
)9 :
(: ;
el64p; @
+A B
$numC E
)E F
)F G
;G H
el 
. 
msg 
= 
Marshal  
.  !
	ReadInt32! *
(* +
(+ ,
IntPtr, 2
)2 3
(3 4
el64p4 9
+: ;
$num< >
)> ?
)? @
;@ A
el 
. 
wParam 
= 
Marshal #
.# $

ReadIntPtr$ .
(. /
(/ 0
IntPtr0 6
)6 7
(7 8
el64p8 =
+> ?
$num@ B
)B C
)C D
;D E
el 
. 
lParam 
= 
Marshal #
.# $

ReadIntPtr$ .
(. /
(/ 0
IntPtr0 6
)6 7
(7 8
el64p8 =
+> ?
$num@ B
)B C
)C D
;D E
el 
. 
	charrange 
. 
cpMin "
=# $
Marshal% ,
., -
	ReadInt32- 6
(6 7
(7 8
IntPtr8 >
)> ?
(? @
el64p@ E
+F G
$numH J
)J K
)K L
;L M
el 
. 
	charrange 
. 
cpMax "
=# $
Marshal% ,
., -
	ReadInt32- 6
(6 7
(7 8
IntPtr8 >
)> ?
(? @
el64p@ E
+F G
$numH J
)J K
)K L
;L M
} 
return 
el 
; 
} 	
internal 
static 
IntPtr 
LoadLibrary *
(* +
string+ 1
filename2 :
): ;
{ 	
var   
module   
=   
LoadLibraryW   %
(  % &
filename  & .
)  . /
;  / 0
if"" 
("" 
module"" 
=="" 
IntPtr""  
.""  !
Zero""! %
)""% &
{## 
int$$ 
error$$ 
=$$ 
Marshal$$ #
.$$# $
GetLastWin32Error$$$ 5
($$5 6
)$$6 7
;$$7 8
throw%% 
new%% 
Win32Exception%% (
(%%( )
error%%) .
)%%. /
;%%/ 0
}&& 
return'' 
module'' 
;'' 
}(( 	
[** 	
	DllImport**	 
(** 
$str** 
,**  
CharSet**! (
=**) *
CharSet**+ 2
.**2 3
Auto**3 7
)**7 8
]**8 9
internal++ 
static++ 
extern++ 
IntPtr++ %
SendMessage++& 1
(++1 2
IntPtr++2 8
HWnd++9 =
,++= >
int++? B
msg++C F
,++F G
int++H K
wparam++L R
,++R S
int++T W
lparam++X ^
)++^ _
;++_ `
[-- 	
	DllImport--	 
(-- 
$str-- 
,--  
CharSet--! (
=--) *
CharSet--+ 2
.--2 3
Auto--3 7
)--7 8
]--8 9
internal.. 
static.. 
extern.. 
IntPtr.. %
SendMessage..& 1
(..1 2
IntPtr..2 8
hWnd..9 =
,..= >
int..? B
msg..C F
,..F G
IntPtr..H N
wparam..O U
,..U V
IntPtr..W ]
lparam..^ d
)..d e
;..e f
[00 	
	DllImport00	 
(00 
$str00 
,00  
CharSet00! (
=00) *
CharSet00+ 2
.002 3
Auto003 7
)007 8
]008 9
internal11 
static11 
extern11 
int11 "
SendMessage11# .
(11. /
IntPtr11/ 5
hWnd116 :
,11: ;
int11< ?
msg11@ C
,11C D
int11E H
wparam11I O
,11O P
[11Q R
	MarshalAs11R [
(11[ \
UnmanagedType11\ i
.11i j
IUnknown11j r
)11r s
]11s t
out11u x
object11y 
editOle
11Ä á
)
11á à
;
11à â
[33 	
	DllImport33	 
(33 
$str33 
,33  
CharSet33! (
=33) *
CharSet33+ 2
.332 3
Auto333 7
)337 8
]338 9
internal44 
static44 
extern44 
int44 "
SendMessage44# .
(44. /
IntPtr44/ 5
hWnd446 :
,44: ;
int44< ?
msg44@ C
,44C D
IntPtr44E K
wparam44L R
,44R S
ref44T W
ImageParameters44X g
lparam44h n
)44n o
;44o p
[66 	
	DllImport66	 
(66 
$str66 
,66  
CharSet66! (
=66) *
CharSet66+ 2
.662 3
Auto663 7
)667 8
]668 9
internal77 
static77 
extern77 
int77 "
SendMessage77# .
(77. /
IntPtr77/ 5
hWnd776 :
,77: ;
int77< ?
msg77@ C
,77C D
ref77E H
TableRowParameters77I [
wParam77\ b
,77b c
ref77d g
TableCellParameters77h {
lParam	77| Ç
)
77Ç É
;
77É Ñ
[99 	
	DllImport99	 
(99 
$str99 
,99  
CharSet99! (
=99) *
CharSet99+ 2
.992 3
Auto993 7
)997 8
]998 9
internal:: 
static:: 
extern:: 
IntPtr:: %
SendMessage::& 1
(::1 2
IntPtr::2 8
hwnd::9 =
,::= >
int::? B
msg::C F
,::F G
IntPtr::H N
wparam::O U
,::U V
ref::W Z
	TextRange::[ d
lparam::e k
)::k l
;::l m
[<< 	
	DllImport<<	 
(<< 
$str<<  
,<<  !
CharSet<<" )
=<<* +
CharSet<<, 3
.<<3 4
Unicode<<4 ;
,<<; <
PreserveSig<<= H
=<<I J
false<<K P
)<<P Q
]<<Q R
internal== 
static== 
extern== 
IStream== &"
SHCreateStreamOnFileEx==' =
(=== >
string==> D
pszFile==E L
,==L M
uint==N R
grfMode==S Z
,==Z [
uint==\ `
dwAttributes==a m
,==m n
bool==o s
fCreate==t {
,=={ |
IStream	==} Ñ
pstmTemplate
==Ö ë
)
==ë í
;
==í ì
[?? 	
	DllImport??	 
(?? 
$str?? !
,??! "

EntryPoint??# -
=??. /
$str??0 >
,??> ?
CharSet??@ G
=??H I
CharSet??J Q
.??Q R
Unicode??R Y
,??Y Z
SetLastError??[ g
=??h i
true??j n
)??n o
]??o p
private@@ 
static@@ 
extern@@ 
IntPtr@@ $
LoadLibraryW@@% 1
(@@1 2
string@@2 8
lpLibFileName@@9 F
)@@F G
;@@G H
}AA 
}BB ¸
KD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\Nmhdr.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[		 
StructLayout		 
(		 

LayoutKind		 
.		 

Sequential		 '
)		' (
]		( )
struct

 

Nmhdr

 
{ 
public 
IntPtr 
hwndFrom 
; 
public 
IntPtr 
idFrom 
; 
public 
int 
code 
; 
} 
} ∂
JD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\Rect.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[ 
StructLayout 
( 

LayoutKind 
. 

Sequential '
)' (
]( )
struct		 

Rect		 
{

 
public 
int 
left 
; 
public 
int 
top 
; 
public 
int 
right 
; 
public 
int 
bottom 
; 
} 
} º
VD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\RichEditMessages.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
class 	
RichEditMessages
 
{ 
public 
const 
int 
EM_FORMATRANGE '
=( )
WindowsMessages* 9
.9 :
WM_USER: A
+B C
$numD F
;F G
public 
const 
int 
EM_GETEDITSTYLE (
=) *
$num+ 1
;1 2
public 
const 
int 
EM_GETLANGOPTIONS *
=+ ,
$num- 3
;3 4
public 
const 
int 
EM_GETOLEINTERFACE +
=, -
$num. 4
;4 5
public 
const 
int 
EM_GETTEXTRANGE (
=) *
$num+ 1
;1 2
public$$ 
const$$ 
int$$ 
EM_INSERTIMAGE$$ '
=$$( )
WindowsMessages$$* 9
.$$9 :
WM_USER$$: A
+$$B C
$num$$D G
;$$G H
public)) 
const)) 
int)) 
EM_INSERTTABLE)) '
=))( )
WindowsMessages))* 9
.))9 :
WM_USER)): A
+))B C
$num))D G
;))G H
public.. 
const.. 
int.. 
EM_SETEDITSTYLE.. (
=..) *
$num..+ 1
;..1 2
public33 
const33 
int33 
EM_SETLANGOPTIONS33 *
=33+ ,
$num33- 3
;333 4
public99 
const99 
int99 
EN_LINK99  
=99! "
$num99# )
;99) *
}:: 
};; ö'
YD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\TableCellParameters.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
struct 

TableCellParameters 
{ 
public 
int 
dxWidth 
; 
private 
ushort 

cellParams !
;! "
public 
ushort 
wShading 
; 
public"" 
short"" 

dxBrdrLeft"" 
;""  
public'' 
short'' 
	dyBrdrTop'' 
;'' 
public,, 
short,, 
dxBrdrRight,,  
;,,  !
public11 
short11 
dyBrdrBottom11 !
;11! "
public66 
int66 

crBrdrLeft66 
;66 
public;; 
int;; 
	crBrdrTop;; 
;;; 
public@@ 
int@@ 
crBrdrRight@@ 
;@@ 
publicEE 
intEE 
crBrdrBottomEE 
;EE  
publicJJ 
intJJ 
	crBackPatJJ 
;JJ 
publicOO 
intOO 
	crForePatOO 
;OO 
publicTT 
ushortTT 
	VertAlignTT 
{UU 	
getVV 
=>VV 
(VV 
ushortVV 
)VV 
(VV 

cellParamsVV &
&VV' (
$numVV) +
)VV+ ,
;VV, -
setWW 
=>WW 

cellParamsWW 
=WW 
(WW  !
ushortWW! '
)WW' (
(WW( )
valueWW) .
|WW/ 0

cellParamsWW1 ;
)WW; <
;WW< =
}XX 	
public]] 
ushort]] 
MergeTop]] 
{^^ 	
get__ 
=>__ 
(__ 
ushort__ 
)__ 
(__ 
(__ 

cellParams__ '
&__( )
$num__* ,
)__, -
/__. /
$num__0 1
)__1 2
;__2 3
set`` 
=>`` 

cellParams`` 
=`` 
(``  !
ushort``! '
)``' (
(``( )
(``) *
value``* /
*``0 1
$num``2 3
)``3 4
|``5 6

cellParams``7 A
)``A B
;``B C
}aa 	
publicff 
ushortff 
	MergePrevff 
{gg 	
gethh 
=>hh 
(hh 
ushorthh 
)hh 
(hh 
(hh 

cellParamshh '
&hh( )
$numhh* ,
)hh, -
/hh. /
$numhh0 1
)hh1 2
;hh2 3
setii 
=>ii 

cellParamsii 
=ii 
(ii  !
ushortii! '
)ii' (
(ii( )
(ii) *
valueii* /
*ii0 1
$numii2 3
)ii3 4
|ii5 6

cellParamsii7 A
)iiA B
;iiB C
}jj 	
publicoo 
ushortoo 
Verticaloo 
{pp 	
getqq 
=>qq 
(qq 
ushortqq 
)qq 
(qq 
(qq 

cellParamsqq '
&qq( )
$numqq* -
)qq- .
/qq/ 0
$numqq1 3
)qq3 4
;qq4 5
setrr 
=>rr 

cellParamsrr 
=rr 
(rr  !
ushortrr! '
)rr' (
(rr( )
(rr) *
valuerr* /
*rr0 1
$numrr2 4
)rr4 5
|rr6 7

cellParamsrr8 B
)rrB C
;rrC D
}ss 	
publicxx 
ushortxx 

MergeStartxx  
{yy 	
getzz 
=>zz 
(zz 
ushortzz 
)zz 
(zz 
(zz 

cellParamszz '
&zz( )
$numzz* -
)zz- .
/zz/ 0
$numzz1 3
)zz3 4
;zz4 5
set{{ 
=>{{ 

cellParams{{ 
={{ 
({{  !
ushort{{! '
){{' (
({{( )
({{) *
value{{* /
*{{0 1
$num{{2 4
){{4 5
|{{6 7

cellParams{{8 B
){{B C
;{{C D
}|| 	
public
ÅÅ 
ushort
ÅÅ 
	MergeCont
ÅÅ 
{
ÇÇ 	
get
ÉÉ 
=>
ÉÉ 
(
ÉÉ 
ushort
ÉÉ 
)
ÉÉ 
(
ÉÉ 
(
ÉÉ 

cellParams
ÉÉ '
&
ÉÉ( )
$num
ÉÉ* -
)
ÉÉ- .
/
ÉÉ/ 0
$num
ÉÉ1 3
)
ÉÉ3 4
;
ÉÉ4 5
set
ÑÑ 
=>
ÑÑ 

cellParams
ÑÑ 
=
ÑÑ 
(
ÑÑ  !
ushort
ÑÑ! '
)
ÑÑ' (
(
ÑÑ( )
(
ÑÑ) *
value
ÑÑ* /
*
ÑÑ0 1
$num
ÑÑ2 4
)
ÑÑ4 5
|
ÑÑ6 7

cellParams
ÑÑ8 B
)
ÑÑB C
;
ÑÑC D
}
ÖÖ 	
}
ÜÜ 
}áá ®
XD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\TableRowParameters.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
struct 

TableRowParameters 
{ 
public 
byte 
cbRow 
; 
public 
byte 
cbCell 
; 
public 
byte 
cCell 
; 
public 
byte 
cRow 
; 
public 
int 
dxCellMargin 
;  
public$$ 
int$$ 
dxIndent$$ 
;$$ 
public)) 
int)) 
dyHeight)) 
;)) 
private33 
uint33 
	rowParams33 
;33 
public99 
int99 

cpStartRow99 
;99 
public>> 
byte>> 
bTableLevel>> 
;>>  
publicCC 
byteCC 
iCellCC 
;CC 
publicHH 
uintHH 
	AlignmentHH 
{II 	
getJJ 
=>JJ 
	rowParamsJJ 
&JJ 
$numJJ !
;JJ! "
setKK 
=>KK 
	rowParamsKK 
=KK 
valueKK $
|KK% &
	rowParamsKK' 0
;KK0 1
}LL 	
publicQQ 
uintQQ 
RtlQQ 
{RR 	
getSS 
=>SS 
(SS 
	rowParamsSS 
&SS 
$numSS  "
)SS" #
/SS$ %
$numSS& '
;SS' (
setTT 
=>TT 
	rowParamsTT 
=TT 
(TT  
valueTT  %
*TT& '
$numTT( )
)TT) *
|TT+ ,
	rowParamsTT- 6
;TT6 7
}UU 	
publicZZ 
uintZZ 
KeepZZ 
{[[ 	
get\\ 
=>\\ 
(\\ 
	rowParams\\ 
&\\ 
$num\\  #
)\\# $
/\\% &
$num\\' )
;\\) *
set]] 
=>]] 
	rowParams]] 
=]] 
(]]  
value]]  %
*]]& '
$num]]( *
)]]* +
|]], -
	rowParams]]. 7
;]]7 8
}^^ 	
publiccc 
uintcc 

KeepFollowcc 
{dd 	
getee 
=>ee 
(ee 
	rowParamsee 
&ee 
$numee  #
)ee# $
/ee% &
$numee' )
;ee) *
setff 
=>ff 
	rowParamsff 
=ff 
(ff  
valueff  %
*ff& '
$numff( *
)ff* +
|ff, -
	rowParamsff. 7
;ff7 8
}gg 	
publicll 
uintll 
Wrapll 
{mm 	
getnn 
=>nn 
(nn 
	rowParamsnn 
&nn 
$numnn  #
)nn# $
/nn% &
$numnn' )
;nn) *
setoo 
=>oo 
	rowParamsoo 
=oo 
(oo  
valueoo  %
*oo& '
$numoo( *
)oo* +
|oo, -
	rowParamsoo. 7
;oo7 8
}pp 	
publicuu 
uintuu 

IdentCellsuu 
{vv 	
getww 
=>ww 
(ww 
	rowParamsww 
&ww 
$numww  $
)ww$ %
/ww& '
$numww( +
;ww+ ,
setxx 
=>xx 
	rowParamsxx 
=xx 
(xx  
valuexx  %
*xx& '
$numxx( +
)xx+ ,
|xx- .
	rowParamsxx/ 8
;xx8 9
}yy 	
}zz 
}{{ ¿
OD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\TextRange.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
[		 
StructLayout		 
(		 

LayoutKind		 
.		 

Sequential		 '
)		' (
]		( )
struct

 

	TextRange

 
{ 
public 
	CharRange 
chrg 
; 
public 
IntPtr 
	lpstrText 
;  
} 
} ›(
WD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\UnicodeCharBuffer.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
abstract		 
class		 

CharBuffer		 
{

 
public 
static 

CharBuffer  
CreateBuffer! -
(- .
int. 1
size2 6
)6 7
=>8 :
new; >
UnicodeCharBuffer? P
(P Q
sizeQ U
)U V
;V W
public 
abstract 
IntPtr 
AllocCoTaskMem -
(- .
). /
;/ 0
public 
abstract 
string 
	GetString (
(( )
)) *
;* +
public"" 
abstract"" 
void"" 
PutCoTaskMem"" )
("") *
IntPtr""* 0
ptr""1 4
)""4 5
;""5 6
public(( 
abstract(( 
void(( 
	PutString(( &
(((& '
string((' -
s((. /
)((/ 0
;((0 1
})) 
class.. 	
UnicodeCharBuffer..
 
:.. 

CharBuffer.. (
{// 
internal00 
char00 
[00 
]00 
buffer00 
;00 
internal11 
int11 
offset11 
;11 
public77 
UnicodeCharBuffer77  
(77  !
int77! $
size77% )
)77) *
=>77+ -
buffer77. 4
=775 6
new777 :
char77; ?
[77? @
size77@ D
]77D E
;77E F
public== 
override== 
IntPtr== 
AllocCoTaskMem== -
(==- .
)==. /
{>> 	
IntPtr?? 
result?? 
=?? 
Marshal?? #
.??# $
AllocCoTaskMem??$ 2
(??2 3
buffer??3 9
.??9 :
Length??: @
*??A B
$num??C D
)??D E
;??E F
Marshal@@ 
.@@ 
Copy@@ 
(@@ 
buffer@@ 
,@@  
$num@@! "
,@@" #
result@@$ *
,@@* +
buffer@@, 2
.@@2 3
Length@@3 9
)@@9 :
;@@: ;
returnAA 
resultAA 
;AA 
}BB 	
publicHH 
overrideHH 
stringHH 
	GetStringHH (
(HH( )
)HH) *
{II 	
intJJ 
iJJ 
=JJ 
offsetJJ 
;JJ 
whileLL 
(LL 
iLL 
<LL 
bufferLL 
.LL 
LengthLL $
&&LL% '
bufferLL( .
[LL. /
iLL/ 0
]LL0 1
!=LL2 4
$numLL5 6
)LL6 7
{MM 
iNN 
++NN 
;NN 
}OO 
stringPP 
resultPP 
=PP 
newPP 
stringPP  &
(PP& '
bufferPP' -
,PP- .
offsetPP/ 5
,PP5 6
iPP7 8
-PP9 :
offsetPP; A
)PPA B
;PPB C
ifRR 
(RR 
iRR 
<RR 
bufferRR 
.RR 
LengthRR !
)RR! "
{SS 
iTT 
++TT 
;TT 
}UU 
offsetVV 
=VV 
iVV 
;VV 
returnWW 
resultWW 
;WW 
}XX 	
public^^ 
override^^ 
void^^ 
PutCoTaskMem^^ )
(^^) *
IntPtr^^* 0
ptr^^1 4
)^^4 5
{__ 	
Marshal`` 
.`` 
Copy`` 
(`` 
ptr`` 
,`` 
buffer`` $
,``$ %
$num``& '
,``' (
buffer``) /
.``/ 0
Length``0 6
)``6 7
;``7 8
offsetaa 
=aa 
$numaa 
;aa 
}bb 	
publichh 
overridehh 
voidhh 
	PutStringhh &
(hh& '
stringhh' -
shh. /
)hh/ 0
{ii 	
intjj 
countjj 
=jj 
Mathjj 
.jj 
Minjj  
(jj  !
sjj! "
.jj" #
Lengthjj# )
,jj) *
bufferjj+ 1
.jj1 2
Lengthjj2 8
-jj9 :
offsetjj; A
)jjA B
;jjB C
skk 
.kk 
CopyTokk 
(kk 
$numkk 
,kk 
bufferkk 
,kk 
offsetkk  &
,kk& '
countkk( -
)kk- .
;kk. /
offsetll 
+=ll 
countll 
;ll 
ifnn 
(nn 
offsetnn 
<nn 
buffernn 
.nn  
Lengthnn  &
)nn& '
{oo 
bufferpp 
[pp 
offsetpp 
++pp 
]pp  
=pp! "
(pp# $
charpp$ (
)pp( )
$numpp) *
;pp* +
}qq 
}rr 	
}ss 
}tt ≈

UD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\PInvoke\WindowsMessages.cs
	namespace 	"
EzWriterCustomControls
  
.  !
PInvoke! (
{ 
class 	
WindowsMessages
 
{ 
public 
const 
int 
WM_KILLFOCUS %
=& '
$num( .
;. /
public 
const 
int 
WM_LBUTTONDOWN '
=( )
$num* 0
;0 1
public 
const 
int 
WM_MOUSEWHEEL &
=' (
$num) /
;/ 0
public 
const 
int 
	WM_NOTIFY "
=# $
$num% +
;+ ,
public 
const 
int 
WM_PAINT !
=" #
$num$ *
;* +
public$$ 
const$$ 
int$$ 
WM_SETCURSOR$$ %
=$$& '
$num$$( .
;$$. /
public)) 
const)) 
int)) 
WM_USER))  
=))! "
$num))# )
;))) *
public.. 
const.. 
int.. 

WM_REFLECT.. #
=..$ %
WM_USER..& -
+... /
$num..0 6
;..6 7
}// 
}00 Ä
UD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 1
)1 2
]2 3
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 3
)3 4
]4 5
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *
VD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\UIElement\DocumentViewer.cs
	namespace 	"
EzWriterCustomControls
  
.  !
	UIElement! *
{ 
public 

partial 
class 
DocumentViewer '
:( )
PrintPreviewControl* =
,= >
IDocumentViewer? N
{ 
public 
DocumentViewer 
( 
) 
=>  "
InitializeComponent# 6
(6 7
)7 8
;8 9
public

 "
IRichEditPrintDocument

 %
PrintDocument

& 3
{ 	
get 
=> 
( !
RichEditPrintDocument )
)) *
Document* 2
;2 3
set 
=> 
Document 
= 
( !
RichEditPrintDocument 4
)4 5
value5 :
;: ;
} 	
} 
} ∂ï
SD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\UIElement\RichEditBox.cs
	namespace 	"
EzWriterCustomControls
  
.  !
	UIElement! *
{ 
[ 
Description 
( 
$str T
)T U
]U V
public 

partial 
class 
RichEditBox $
:% &
RichTextBox' 2
,2 3
IRichEditBox4 @
{ 
private 
const 
double 
inch !
=" #
$num$ (
;( )
private 
const 
int !
SES_HYPERLINKTOOLTIPS /
=0 1
$num2 3
;3 4
private 
readonly 
List 
< 
string $
>$ %
misspelledWords& 5
;5 6
private 
readonly 

Dictionary #
<# $
string$ *
,* +
EzWriterModel, 9
.9 :
Entities: B
.B C
	TextRangeC L
>L M
rangesN T
;T U
private 
readonly 
SpellChecker %
spellChecker& 2
;2 3
private 
string 
wildcardWord #
;# $
private 
bool 
showStandardMenu %
=& '
true( ,
;, -
private 
bool 
hasSpellingErrors &
=' (
false) .
;. /
private 
bool 
wordTypedCompleted '
=( )
false* /
;/ 0
public   
RichEditBox   
(   
)   
{!! 	
InitializeComponent"" 
(""  
)""  !
;""! "
misspelledWords## 
=## 
new## !
List##" &
<##& '
string##' -
>##- .
(##. /
)##/ 0
;##0 1
ranges$$ 
=$$ 
new$$ 

Dictionary$$ #
<$$# $
string$$$ *
,$$* +
EzWriterModel$$, 9
.$$9 :
Entities$$: B
.$$B C
	TextRange$$C L
>$$L M
($$M N
)$$N O
;$$O P
spellChecker%% 
=%% 
new%% 
SpellChecker%% +
(%%+ ,
)%%, -
;%%- .
contextMenu&& 
.&& 
Renderer&&  
=&&! "
new&&# &*
FluentContextMenuStripRenderer&&' E
(&&E F
)&&F G
;&&G H
ContextMenuStrip'' 
='' 
contextMenu'' *
;''* +
ContextMenuStrip(( 
.(( 
Opened(( #
+=(($ &%
OnContextMenuStrip_Opened((' @
;((@ A 
RaiseMenuItemsEvents))  
())  !
)))! "
;))" #
}** 	
[.. 	
	Browsable..	 
(.. 
false.. 
).. 
].. 
public// 
TextDocument// 
Document// $
=>//% '
new//( +
TextDocument//, 8
(//8 9
this//9 =
,//= >
	IDocument//? H
)//H I
;//I J
[11 	
DefaultValue11	 
(11 
false11 
)11 
]11 
public22 
bool22 
IsSpellCheckEnabled22 '
{22( )
get22* -
;22- .
set22/ 2
;222 3
}224 5
=226 7
false228 =
;22= >
[44 	
	Browsable44	 
(44 
false44 
)44 
]44 
public55 "
IRichEditPrintDocument55 %
PrintDocument55& 3
=>554 6
new557 :!
RichEditPrintDocument55; P
(55P Q
this55Q U
)55U V
;55V W
public;; 
int;; 
FormatRange;; 
(;; 
PrintPageEventArgs;; 1
e;;2 3
,;;3 4
int;;5 8
charFrom;;9 A
,;;A B
int;;C F
charTo;;G M
);;M N
{<< 	
var== 
range== 
=== 
new== 
	CharRange== %
{>> 
cpMin?? 
=?? 
charFrom??  
,??  !
cpMax@@ 
=@@ 
charTo@@ 
}AA 
;AA 
varBB 
rectBB 
=BB 
newBB 
RectBB 
{CC 
topDD 
=DD 
(DD 
intDD 
)DD 
(DD 
eDD 
.DD 
MarginBoundsDD *
.DD* +
TopDD+ .
*DD/ 0
inchDD1 5
)DD5 6
,DD6 7
bottomEE 
=EE 
(EE 
intEE 
)EE 
(EE 
eEE  
.EE  !
MarginBoundsEE! -
.EE- .
BottomEE. 4
*EE5 6
inchEE7 ;
)EE; <
,EE< =
leftFF 
=FF 
(FF 
intFF 
)FF 
(FF 
eFF 
.FF 
MarginBoundsFF +
.FF+ ,
LeftFF, 0
*FF1 2
inchFF3 7
)FF7 8
,FF8 9
rightGG 
=GG 
(GG 
intGG 
)GG 
(GG 
eGG 
.GG  
MarginBoundsGG  ,
.GG, -
RightGG- 2
*GG3 4
inchGG5 9
)GG9 :
}HH 
;HH 
varII 
rectPageII 
=II 
newII 
RectII #
{JJ 
topKK 
=KK 
(KK 
intKK 
)KK 
(KK 
eKK 
.KK 

PageBoundsKK (
.KK( )
TopKK) ,
*KK- .
inchKK/ 3
)KK3 4
,KK4 5
bottomLL 
=LL 
(LL 
intLL 
)LL 
(LL 
eLL  
.LL  !

PageBoundsLL! +
.LL+ ,
BottomLL, 2
*LL3 4
inchLL5 9
)LL9 :
,LL: ;
leftMM 
=MM 
(MM 
intMM 
)MM 
(MM 
eMM 
.MM 

PageBoundsMM )
.MM) *
LeftMM* .
*MM/ 0
inchMM1 5
)MM5 6
,MM6 7
rightNN 
=NN 
(NN 
intNN 
)NN 
(NN 
eNN 
.NN  

PageBoundsNN  *
.NN* +
RightNN+ 0
*NN1 2
inchNN3 7
)NN7 8
}OO 
;OO 
IntPtrPP 
hdcPP 
=PP 
ePP 
.PP 
GraphicsPP #
.PP# $
GetHdcPP$ *
(PP* +
)PP+ ,
;PP, -
varRR 
formatRangeRR 
=RR 
newRR !
FormatRangeRR" -
{SS 
chrgTT 
=TT 
rangeTT 
,TT 
hdcUU 
=UU 
hdcUU 
,UU 
	hdcTargetVV 
=VV 
hdcVV 
,VV  
rcWW 
=WW 
rectWW 
,WW 
rcPageXX 
=XX 
rectPageXX !
}YY 
;YY 
IntPtrZZ 
lParamZZ 
=ZZ 
MarshalZZ #
.ZZ# $
AllocCoTaskMemZZ$ 2
(ZZ2 3
MarshalZZ3 :
.ZZ: ;
SizeOfZZ; A
(ZZA B
formatRangeZZB M
)ZZM N
)ZZN O
;ZZO P
Marshal[[ 
.[[ 
StructureToPtr[[ "
([[" #
formatRange[[# .
,[[. /
lParam[[0 6
,[[6 7
false[[8 =
)[[= >
;[[> ?
IntPtr]] 
result]] 
=]] 
NativeMethods]] )
.]]) *
SendMessage]]* 5
(]]5 6
Handle]]6 <
,]]< =
RichEditMessages]]> N
.]]N O
EM_FORMATRANGE]]O ]
,]]] ^
(]]_ `
IntPtr]]` f
)]]f g
$num]]g h
,]]h i
lParam]]j p
)]]p q
;]]q r
Marshal__ 
.__ 
FreeCoTaskMem__ !
(__! "
lParam__" (
)__( )
;__) *
e`` 
.`` 
Graphics`` 
.`` 

ReleaseHdc`` !
(``! "
hdc``" %
)``% &
;``& '
returnbb 
resultbb 
.bb 
ToInt32bb !
(bb! "
)bb" #
;bb# $
}cc 	
publicee 
voidee 
FormatRangeDoneee #
(ee# $
)ee$ %
=>ee& (
NativeMethodsee) 6
.ee6 7
SendMessageee7 B
(eeB C
HandleeeC I
,eeI J
RichEditMessageseeK [
.ee[ \
EM_FORMATRANGEee\ j
,eej k
IntPtreel r
.eer s
Zeroees w
,eew x
IntPtreey 
.	ee Ä
Zero
eeÄ Ñ
)
eeÑ Ö
;
eeÖ Ü
publicgg 
voidgg 
InsertImagegg 
(gg  
intgg  #
ascentgg$ *
,gg* +&
VerticalCharacterAlignmentgg, F
verticalAlignggG T
,ggT U
stringggV \
filenamegg] e
)gge f
{hh 	
usingii 
(ii 
varii 
imageii 
=ii 
Imageii $
.ii$ %
FromFileii% -
(ii- .
filenameii. 6
)ii6 7
)ii7 8
{jj 
InsertImagekk 
(kk 
imagekk !
.kk! "
HiMetricWidthkk" /
(kk/ 0
)kk0 1
*kk2 3
$numkk4 5
/kk6 7
$numkk8 9
,kk9 :
imagekk; @
.kk@ A
HiMetricHeightkkA O
(kkO P
)kkP Q
*kkR S
$numkkT U
/kkV W
$numkkX Y
,kkY Z
ascentkk[ a
,kka b
verticalAlignll )
,ll) *
filenamell+ 3
,ll3 4
filenamell5 =
)ll= >
;ll> ?
}mm 
}nn 	
publicpp 
voidpp 
InsertImagepp 
(pp  
intpp  #
widthpp$ )
,pp) *
intpp+ .
heightpp/ 5
,pp5 6
intpp7 :
ascentpp; A
,ppA B&
VerticalCharacterAlignmentppC ]
verticalAlignpp^ k
,ppk l
stringqq  &
alternateTextqq' 4
,qq4 5
stringqq6 <
filenameqq= E
)qqE F
{rr 	
varss 
imagess 
=ss 
newss 
ImageParametersss +
{tt 
xWidthuu 
=uu 
widthuu 
,uu 
yHeightvv 
=vv 
heightvv  
,vv  !
ascentww 
=ww 
ascentww 
,ww  
typexx 
=xx 
(xx 
intxx 
)xx 
verticalAlignxx )
,xx) *
pwszAlternateTextyy !
=yy" #
alternateTextyy$ 1
,yy1 2
pIStreamzz 
=zz 
NativeMethodszz (
.zz( )"
SHCreateStreamOnFileExzz) ?
(zz? @
filenamezz@ H
,zzH I
(zzJ K
intzzK N
)zzN O
$numzzO Z
,zzZ [
$numzz\ _
,zz_ `
falsezza f
,zzf g
nullzzh l
)zzl m
}{{ 
;{{ 
NativeMethods|| 
.|| 
SendMessage|| %
(||% &
Handle||& ,
,||, -
RichEditMessages||. >
.||> ?
EM_INSERTIMAGE||? M
,||M N
IntPtr||O U
.||U V
Zero||V Z
,||Z [
ref||\ _
image||` e
)||e f
;||f g
}}} 	
public 
void 
InsertTable 
(  
int  #
numCols$ +
,+ ,
int- 0
numRows1 8
,8 9
Color: ?
borderColor@ K
,K L
ColorM R
cellBackColorS `
,` a
Colorb g
cellForeColorh u
)u v
{
ÄÄ 	
var
ÅÅ 
rows
ÅÅ 
=
ÅÅ 
new
ÅÅ  
TableRowParameters
ÅÅ -
(
ÅÅ- .
)
ÅÅ. /
;
ÅÅ/ 0
var
ÇÇ 
cells
ÇÇ 
=
ÇÇ 
new
ÇÇ !
TableCellParameters
ÇÇ /
(
ÇÇ/ 0
)
ÇÇ0 1
;
ÇÇ1 2
rows
ÉÉ 
.
ÉÉ 
cbRow
ÉÉ 
=
ÉÉ 
(
ÉÉ 
byte
ÉÉ 
)
ÉÉ 
(
ÉÉ  
Marshal
ÉÉ  '
.
ÉÉ' (
SizeOf
ÉÉ( .
(
ÉÉ. /
rows
ÉÉ/ 3
)
ÉÉ3 4
-
ÉÉ5 6
$num
ÉÉ7 8
*
ÉÉ9 :
sizeof
ÉÉ; A
(
ÉÉA B
int
ÉÉB E
)
ÉÉE F
)
ÉÉF G
;
ÉÉG H
rows
ÑÑ 
.
ÑÑ 
cbCell
ÑÑ 
=
ÑÑ 
(
ÑÑ 
byte
ÑÑ 
)
ÑÑ  
Marshal
ÑÑ  '
.
ÑÑ' (
SizeOf
ÑÑ( .
(
ÑÑ. /
cells
ÑÑ/ 4
)
ÑÑ4 5
;
ÑÑ5 6
rows
ÜÜ 
.
ÜÜ 
cCell
ÜÜ 
=
ÜÜ 
(
ÜÜ 
byte
ÜÜ 
)
ÜÜ 
numCols
ÜÜ &
;
ÜÜ& '
rows
áá 
.
áá 
cRow
áá 
=
áá 
(
áá 
byte
áá 
)
áá 
numRows
áá %
;
áá% &
rows
àà 
.
àà 
dxCellMargin
àà 
=
àà 
$num
àà  "
;
àà" #
rows
ââ 
.
ââ 
	Alignment
ââ 
=
ââ 
$num
ââ 
;
ââ 
rows
ää 
.
ää 

IdentCells
ää 
=
ää 
$num
ää 
;
ää  
rows
ãã 
.
ãã 

cpStartRow
ãã 
=
ãã 
$num
ãã 
;
ãã  
cells
çç 
.
çç 
dxWidth
çç 
=
çç 
Width
çç !
/
çç" #
numCols
çç$ +
*
çç, -
$num
çç. 0
;
çç0 1
cells
éé 
.
éé 

dxBrdrLeft
éé 
=
éé 
$num
éé  
;
éé  !
cells
èè 
.
èè 
dxBrdrRight
èè 
=
èè 
$num
èè  !
;
èè! "
cells
êê 
.
êê 
dyBrdrBottom
êê 
=
êê  
$num
êê! "
;
êê" #
cells
ëë 
.
ëë 
	dyBrdrTop
ëë 
=
ëë 
$num
ëë 
;
ëë  
cells
íí 
.
íí 
crBrdrBottom
íí 
=
íí  
ColorTranslator
íí! 0
.
íí0 1
ToWin32
íí1 8
(
íí8 9
borderColor
íí9 D
)
ííD E
;
ííE F
cells
ìì 
.
ìì 

crBrdrLeft
ìì 
=
ìì 
ColorTranslator
ìì .
.
ìì. /
ToWin32
ìì/ 6
(
ìì6 7
borderColor
ìì7 B
)
ììB C
;
ììC D
cells
îî 
.
îî 
crBrdrRight
îî 
=
îî 
ColorTranslator
îî  /
.
îî/ 0
ToWin32
îî0 7
(
îî7 8
borderColor
îî8 C
)
îîC D
;
îîD E
cells
ïï 
.
ïï 
	crBrdrTop
ïï 
=
ïï 
ColorTranslator
ïï -
.
ïï- .
ToWin32
ïï. 5
(
ïï5 6
borderColor
ïï6 A
)
ïïA B
;
ïïB C
cells
ññ 
.
ññ 
	crBackPat
ññ 
=
ññ 
ColorTranslator
ññ -
.
ññ- .
ToWin32
ññ. 5
(
ññ5 6
cellBackColor
ññ6 C
)
ññC D
;
ññD E
cells
óó 
.
óó 
	crForePat
óó 
=
óó 
ColorTranslator
óó -
.
óó- .
ToWin32
óó. 5
(
óó5 6
cellForeColor
óó6 C
)
óóC D
;
óóD E
NativeMethods
ôô 
.
ôô 
SendMessage
ôô %
(
ôô% &
Handle
ôô& ,
,
ôô, -
RichEditMessages
ôô. >
.
ôô> ?
EM_INSERTTABLE
ôô? M
,
ôôM N
ref
ôôO R
rows
ôôS W
,
ôôW X
ref
ôôY \
cells
ôô] b
)
ôôb c
;
ôôc d
}
öö 	
	protected
†† 
override
†† 
CreateParams
†† '
CreateParams
††( 4
{
°° 	
get
¢¢ 
{
££ 
var
§§ 
cp
§§ 
=
§§ 
base
§§ 
.
§§ 
CreateParams
§§ *
;
§§* +
NativeMethods
•• 
.
•• 
LoadLibrary
•• )
(
••) *
$str
••* 8
)
••8 9
;
••9 :
cp
¶¶ 
.
¶¶ 
	ClassName
¶¶ 
=
¶¶ 
$str
¶¶ ,
;
¶¶, -
return
ßß 
cp
ßß 
;
ßß 
}
®® 
}
©© 	
	protected
´´ 
virtual
´´ 
ITextDocument2
´´ (
	IDocument
´´) 2
=>
¨¨ 
NativeMethods
¨¨ 
.
¨¨ 
SendMessage
¨¨ (
(
¨¨( )
Handle
¨¨) /
,
¨¨/ 0
RichEditMessages
¨¨1 A
.
¨¨A B 
EM_GETOLEINTERFACE
¨¨B T
,
¨¨T U
$num
¨¨V W
,
¨¨W X
out
¨¨Y \
object
¨¨] c
ole
¨¨d g
)
¨¨g h
!=
¨¨i k
$num
¨¨l m
?
¨¨n o
(
¨¨p q
ITextDocument2
¨¨q 
)¨¨ Ä
ole¨¨Ä É
:¨¨Ñ Ö
null¨¨Ü ä
;¨¨ä ã
	protected
ÆÆ 
override
ÆÆ 
void
ÆÆ 
OnHandleCreated
ÆÆ  /
(
ÆÆ/ 0
	EventArgs
ÆÆ0 9
e
ÆÆ: ;
)
ÆÆ; <
{
ØØ 	
base
∞∞ 
.
∞∞ 
OnHandleCreated
∞∞  
(
∞∞  !
e
∞∞! "
)
∞∞" #
;
∞∞# $
NativeMethods
±± 
.
±± 
SendMessage
±± %
(
±±% &
Handle
±±& ,
,
±±, -
RichEditMessages
±±. >
.
±±> ?
EM_SETEDITSTYLE
±±? N
,
±±N O#
SES_HYPERLINKTOOLTIPS
±±P e
,
±±e f#
SES_HYPERLINKTOOLTIPS
±±g |
)
±±| }
;
±±} ~
}
≤≤ 	
	protected
¥¥ 
override
¥¥ 
void
¥¥ 
	OnKeyDown
¥¥  )
(
¥¥) *
KeyEventArgs
¥¥* 6
e
¥¥7 8
)
¥¥8 9
{
µµ 	
base
∂∂ 
.
∂∂ 
	OnKeyDown
∂∂ 
(
∂∂ 
e
∂∂ 
)
∂∂ 
;
∂∂ 
if
∏∏ 
(
∏∏ "
GetLineFromCharIndex
∏∏ $
(
∏∏$ %
SelectionStart
∏∏% 3
)
∏∏3 4
==
∏∏5 7
$num
∏∏8 9
&&
∏∏: <
e
∏∏= >
.
∏∏> ?
KeyData
∏∏? F
==
∏∏G I
Keys
∏∏J N
.
∏∏N O
Up
∏∏O Q
||
∏∏R T"
GetLineFromCharIndex
ππ $
(
ππ$ %
SelectionStart
ππ% 3
)
ππ3 4
==
ππ5 7"
GetLineFromCharIndex
ππ8 L
(
ππL M

TextLength
ππM W
)
ππW X
&&
ππY [
e
ππ\ ]
.
ππ] ^
KeyData
ππ^ e
==
ππf h
Keys
ππi m
.
ππm n
Down
ππn r
||
ππs u
SelectionStart
∫∫ 
==
∫∫ !

TextLength
∫∫" ,
&&
∫∫- /
e
∫∫0 1
.
∫∫1 2
KeyData
∫∫2 9
==
∫∫: <
Keys
∫∫= A
.
∫∫A B
Right
∫∫B G
||
∫∫H J
SelectionStart
ªª 
==
ªª !
$num
ªª" #
&&
ªª$ &
e
ªª' (
.
ªª( )
KeyData
ªª) 0
==
ªª1 3
Keys
ªª4 8
.
ªª8 9
Left
ªª9 =
)
ªª= >
{
ºº 
e
ΩΩ 
.
ΩΩ 
Handled
ΩΩ 
=
ΩΩ 
true
ΩΩ  
;
ΩΩ  !
}
ææ 
if
øø 
(
øø 
e
øø 
.
øø 
KeyCode
øø 
==
øø 
Keys
øø !
.
øø! "
Space
øø" '
||
øø( *
e
øø+ ,
.
øø, -
KeyCode
øø- 4
==
øø5 7
Keys
øø8 <
.
øø< =
Tab
øø= @
||
øøA C
e
øøD E
.
øøE F
KeyCode
øøF M
==
øøN P
Keys
øøQ U
.
øøU V
Enter
øøV [
||
øø\ ^
e
¿¿ 
.
¿¿ 
KeyData
¿¿ 
==
¿¿ 
(
¿¿ 
Keys
¿¿ "
.
¿¿" #
Control
¿¿# *
|
¿¿+ ,
Keys
¿¿- 1
.
¿¿1 2
V
¿¿2 3
)
¿¿3 4
)
¿¿4 5
{
¡¡  
wordTypedCompleted
¬¬ "
=
¬¬# $
true
¬¬% )
;
¬¬) *
}
√√ 
else
ƒƒ 
{
≈≈  
wordTypedCompleted
∆∆ "
=
∆∆# $
false
∆∆% *
;
∆∆* +
}
«« 
}
»» 	
	protected
   
override
   
void
   
OnLinkClicked
    -
(
  - ."
LinkClickedEventArgs
  . B
e
  C D
)
  D E
{
ÀÀ 	
base
ÃÃ 
.
ÃÃ 
OnLinkClicked
ÃÃ 
(
ÃÃ 
e
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
var
ÕÕ 
question
ÕÕ 
=
ÕÕ 
$"
ÕÕ &
¬øDesea abrir el enlace 
ÕÕ 4
{
ÕÕ4 5
e
ÕÕ5 6
.
ÕÕ6 7
LinkText
ÕÕ7 ?
}
ÕÕ? @
?
ÕÕ@ A
"
ÕÕA B
;
ÕÕB C
if
œœ 
(
œœ 

MessageBox
œœ 
.
œœ 
Show
œœ 
(
œœ  
question
œœ  (
,
œœ( )
string
œœ* 0
.
œœ0 1
Empty
œœ1 6
,
œœ6 7
MessageBoxButtons
œœ8 I
.
œœI J
YesNo
œœJ O
)
œœO P
==
œœQ S
DialogResult
œœT `
.
œœ` a
Yes
œœa d
)
œœd e
{
–– 
Process
—— 
.
—— 
Start
—— 
(
—— 
e
—— 
.
——  
LinkText
——  (
)
——( )
;
——) *
}
““ 
}
”” 	
	protected
’’ 
override
’’ 
void
’’ 
OnMouseDown
’’  +
(
’’+ ,
MouseEventArgs
’’, :
e
’’; <
)
’’< =
{
÷÷ 	
base
◊◊ 
.
◊◊ 
OnMouseDown
◊◊ 
(
◊◊ 
e
◊◊ 
)
◊◊ 
;
◊◊  
if
ŸŸ 
(
ŸŸ 
e
ŸŸ 
.
ŸŸ 
Button
ŸŸ 
==
ŸŸ 
MouseButtons
ŸŸ (
.
ŸŸ( )
Right
ŸŸ) .
&&
ŸŸ/ 1
e
ŸŸ2 3
.
ŸŸ3 4
Clicks
ŸŸ4 :
==
ŸŸ; =
$num
ŸŸ> ?
)
ŸŸ? @
{
⁄⁄ 
var
€€ 
currentWord
€€ 
=
€€  !!
GetWordFromPosition
€€" 5
(
€€5 6
e
€€6 7
.
€€7 8
Location
€€8 @
)
€€@ A
;
€€A B
for
›› 
(
›› 
int
›› 
i
›› 
=
›› 
$num
›› 
;
›› 
i
››  !
<
››" #
misspelledWords
››$ 3
.
››3 4
Count
››4 9
;
››9 :
i
››; <
++
››< >
)
››> ?
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ 
misspelledWords
ﬂﬂ '
.
ﬂﬂ' (
Contains
ﬂﬂ( 0
(
ﬂﬂ0 1
currentWord
ﬂﬂ1 <
)
ﬂﬂ< =
)
ﬂﬂ= >
{
‡‡ 
wildcardWord
·· $
=
··% &
currentWord
··' 2
;
··2 3
showStandardMenu
‚‚ (
=
‚‚) *
false
‚‚+ 0
;
‚‚0 1
return
„„ 
;
„„ 
}
‰‰ 
}
ÂÂ 
showStandardMenu
ÊÊ  
=
ÊÊ! "
true
ÊÊ# '
;
ÊÊ' (
}
ÁÁ 
}
ËË 	
	protected
ÍÍ 
override
ÍÍ 
void
ÍÍ 
OnTextChanged
ÍÍ  -
(
ÍÍ- .
	EventArgs
ÍÍ. 7
e
ÍÍ8 9
)
ÍÍ9 :
{
ÎÎ 	
base
ÏÏ 
.
ÏÏ 
OnTextChanged
ÏÏ 
(
ÏÏ 
e
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
if
ÓÓ 
(
ÓÓ !
IsSpellCheckEnabled
ÓÓ #
&&
ÓÓ$ & 
wordTypedCompleted
ÓÓ' 9
&&
ÓÓ: <
!
ÓÓ= >
string
ÓÓ> D
.
ÓÓD E
IsNullOrEmpty
ÓÓE R
(
ÓÓR S
Text
ÓÓS W
)
ÓÓW X
)
ÓÓX Y
{
ÔÔ 
var
 
spellingErrors
 "
=
# $
spellChecker
% 1
.
1 2
Check
2 7
(
7 8
Document
8 @
.
@ A
EntireRange
A L
.
L M
Text
M Q
)
Q R
;
R S
if
ÚÚ 
(
ÚÚ 
spellingErrors
ÚÚ "
.
ÚÚ" #
Any
ÚÚ# &
(
ÚÚ& '
)
ÚÚ' (
)
ÚÚ( )
{
ÛÛ 
hasSpellingErrors
ÙÙ %
=
ÙÙ& '
true
ÙÙ( ,
;
ÙÙ, -
foreach
ˆˆ 
(
ˆˆ 
var
ˆˆ  
spellingError
ˆˆ! .
in
ˆˆ/ 1
spellingErrors
ˆˆ2 @
)
ˆˆ@ A
{
˜˜ 
var
¯¯ 
range
¯¯ !
=
¯¯" #
Document
¯¯$ ,
.
¯¯, -
GetRange
¯¯- 5
(
¯¯5 6
spellingError
¯¯6 C
.
¯¯C D

StartIndex
¯¯D N
,
¯¯N O
spellingError
¯¯P ]
.
¯¯] ^

StartIndex
¯¯^ h
+
¯¯i j
spellingError
¯¯k x
.
¯¯x y
Length
¯¯y 
)¯¯ Ä
;¯¯Ä Å
var
˘˘ 
misspelledWord
˘˘ *
=
˘˘+ ,
range
˘˘- 2
.
˘˘2 3
Text
˘˘3 7
;
˘˘7 8
misspelledWords
˙˙ '
.
˙˙' (
Add
˙˙( +
(
˙˙+ ,
misspelledWord
˙˙, :
)
˙˙: ;
;
˙˙; <
if
¸¸ 
(
¸¸ 
!
¸¸ 
ranges
¸¸ #
.
¸¸# $
ContainsKey
¸¸$ /
(
¸¸/ 0
misspelledWord
¸¸0 >
)
¸¸> ?
)
¸¸? @
{
˝˝ 
ranges
˛˛ "
.
˛˛" #
Add
˛˛# &
(
˛˛& '
misspelledWord
˛˛' 5
,
˛˛5 6
range
˛˛7 <
)
˛˛< =
;
˛˛= >
}
ˇˇ 
var
ÄÄ 
font
ÄÄ  
=
ÄÄ! "
range
ÄÄ# (
.
ÄÄ( )
Font
ÄÄ) -
;
ÄÄ- .
font
ÅÅ 
.
ÅÅ 
Reset
ÅÅ "
(
ÅÅ" #
(
ÅÅ# $
int
ÅÅ$ '
)
ÅÅ' (
tomConstants
ÅÅ( 4
.
ÅÅ4 5
tomApplyTmp
ÅÅ5 @
)
ÅÅ@ A
;
ÅÅA B
font
ÇÇ 
.
ÇÇ 
	Underline
ÇÇ &
=
ÇÇ' (
(
ÇÇ) *
int
ÇÇ* -
)
ÇÇ- .
UnderlineStyle
ÇÇ. <
.
ÇÇ< =
Wave
ÇÇ= A
;
ÇÇA B
font
ÉÉ 
.
ÉÉ 
	Underline
ÉÉ &
=
ÉÉ' (
	unchecked
ÉÉ) 2
(
ÉÉ2 3
(
ÉÉ3 4
int
ÉÉ4 7
)
ÉÉ7 8
$num
ÉÉ8 B
)
ÉÉB C
;
ÉÉC D
font
ÑÑ 
.
ÑÑ 
Reset
ÑÑ "
(
ÑÑ" #
(
ÑÑ# $
int
ÑÑ$ '
)
ÑÑ' (
tomConstants
ÑÑ( 4
.
ÑÑ4 5
tomApplyNow
ÑÑ5 @
)
ÑÑ@ A
;
ÑÑA B
}
ÖÖ 
}
ÜÜ 
}
áá 
}
àà 	
	protected
ää 
override
ää 
void
ää 
WndProc
ää  '
(
ää' (
ref
ää( +
Message
ää, 3
m
ää4 5
)
ää5 6
{
ãã 	
if
åå 
(
åå 
m
åå 
.
åå 
Msg
åå 
==
åå 
WindowsMessages
åå (
.
åå( )
WM_SETCURSOR
åå) 5
)
åå5 6
{
çç 
if
éé 
(
éé 
SelectionType
éé !
==
éé" $'
RichTextBoxSelectionTypes
éé% >
.
éé> ?
Object
éé? E
)
ééE F
{
èè 

DefWndProc
êê 
(
êê 
ref
êê "
m
êê# $
)
êê$ %
;
êê% &
return
ëë 
;
ëë 
}
íí 
}
ìì 
if
îî 
(
îî 
m
îî 
.
îî 
Msg
îî 
==
îî 
(
îî 
WindowsMessages
îî )
.
îî) *

WM_REFLECT
îî* 4
|
îî5 6
WindowsMessages
îî7 F
.
îîF G
	WM_NOTIFY
îîG P
)
îîP Q
)
îîQ R
{
ïï 
Nmhdr
ññ 
hdr
ññ 
=
ññ 
(
ññ 
Nmhdr
ññ "
)
ññ" #
m
ññ# $
.
ññ$ %
	GetLParam
ññ% .
(
ññ. /
typeof
ññ/ 5
(
ññ5 6
Nmhdr
ññ6 ;
)
ññ; <
)
ññ< =
;
ññ= >
if
òò 
(
òò 
hdr
òò 
.
òò 
code
òò 
==
òò 
RichEditMessages
òò  0
.
òò0 1
EN_LINK
òò1 8
)
òò8 9
{
ôô 
var
öö 
link
öö 
=
öö 
IntPtr
öö %
.
öö% &
Size
öö& *
==
öö+ -
$num
öö. /
?
öö0 1
(
öö2 3
EnLink
öö3 9
)
öö9 :
m
öö: ;
.
öö; <
	GetLParam
öö< E
(
ööE F
typeof
ööF L
(
ööL M
EnLink
ööM S
)
ööS T
)
ööT U
:
õõ3 4
NativeMethods
õõ5 B
.
õõB C!
ConvertFromENLINK64
õõC V
(
õõV W
(
õõW X
EnLink64
õõX `
)
õõ` a
m
õõa b
.
õõb c
	GetLParam
õõc l
(
õõl m
typeof
õõm s
(
õõs t
EnLink64
õõt |
)
õõ| }
)
õõ} ~
)
õõ~ 
;õõ Ä
if
úú 
(
úú 
link
úú 
.
úú 
msg
úú  
==
úú! #
WindowsMessages
úú$ 3
.
úú3 4
WM_LBUTTONDOWN
úú4 B
)
úúB C
{
ùù 
string
ûû 
linkText
ûû '
=
ûû( )
CharRangeToString
ûû* ;
(
ûû; <
link
ûû< @
.
ûû@ A
	charrange
ûûA J
)
ûûJ K
;
ûûK L
if
†† 
(
†† 
!
†† 
string
†† #
.
††# $
IsNullOrEmpty
††$ 1
(
††1 2
linkText
††2 :
)
††: ;
)
††; <
{
°° 
OnLinkClicked
¢¢ )
(
¢¢) *
new
¢¢* -"
LinkClickedEventArgs
¢¢. B
(
¢¢B C
linkText
¢¢C K
)
¢¢K L
)
¢¢L M
;
¢¢M N
}
££ 
m
§§ 
.
§§ 
Result
§§  
=
§§! "
(
§§# $
IntPtr
§§$ *
)
§§* +
$num
§§+ ,
;
§§, -
return
•• 
;
•• 
}
¶¶ 
}
ßß 
}
®® 
base
©© 
.
©© 
WndProc
©© 
(
©© 
ref
©© 
m
©© 
)
©© 
;
©©  
}
™™ 	
	protected
∞∞ 
override
∞∞ 
void
∞∞ 
Dispose
∞∞  '
(
∞∞' (
bool
∞∞( ,
	disposing
∞∞- 6
)
∞∞6 7
{
±± 	
if
≤≤ 
(
≤≤ 
	disposing
≤≤ 
&&
≤≤ 
(
≤≤ 

components
≤≤ (
!=
≤≤) +
null
≤≤, 0
)
≤≤0 1
)
≤≤1 2
{
≥≥ 

components
¥¥ 
.
¥¥ 
Dispose
¥¥ "
(
¥¥" #
)
¥¥# $
;
¥¥$ %
spellChecker
µµ 
.
µµ 
Dispose
µµ $
(
µµ$ %
)
µµ% &
;
µµ& '
}
∂∂ 
base
∑∑ 
.
∑∑ 
Dispose
∑∑ 
(
∑∑ 
	disposing
∑∑ "
)
∑∑" #
;
∑∑# $
}
∏∏ 	
private
ææ 
void
ææ '
OnContextMenuStrip_Opened
ææ .
(
ææ. /
object
ææ/ 5
sender
ææ6 <
,
ææ< =
	EventArgs
ææ> G
e
ææH I
)
ææI J
{
øø 	
if
¿¿ 
(
¿¿ 
hasSpellingErrors
¿¿ !
)
¿¿! "
{
¡¡ 
ContextMenuStrip
¬¬  
.
¬¬  !
Items
¬¬! &
.
¬¬& '
Clear
¬¬' ,
(
¬¬, -
)
¬¬- .
;
¬¬. /
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
showStandardMenu
ƒƒ %
)
ƒƒ% &
{
≈≈ 
int
∆∆ 
index
∆∆ 
=
∆∆ 
$num
∆∆  !
;
∆∆! "
var
»» 
suggestions
»» #
=
»»$ %
spellChecker
»»& 2
.
»»2 3
GetSuggestions
»»3 A
(
»»A B
wildcardWord
»»B N
)
»»N O
;
»»O P
if
   
(
   
suggestions
   #
.
  # $
Any
  $ '
(
  ' (
)
  ( )
)
  ) *
{
ÀÀ 
foreach
ÃÃ 
(
ÃÃ  !
var
ÃÃ! $

suggestion
ÃÃ% /
in
ÃÃ0 2
suggestions
ÃÃ3 >
)
ÃÃ> ?
{
ÕÕ 
var
ŒŒ 
item
ŒŒ  $
=
ŒŒ% &
new
ŒŒ' *
ToolStripMenuItem
ŒŒ+ <
{
ŒŒ= >
Text
ŒŒ? C
=
ŒŒD E

suggestion
ŒŒF P
}
ŒŒQ R
;
ŒŒR S
ContextMenuStrip
œœ ,
.
œœ, -
Items
œœ- 2
.
œœ2 3
Insert
œœ3 9
(
œœ9 :
index
œœ: ?
,
œœ? @
item
œœA E
)
œœE F
;
œœF G
item
––  
.
––  !
Click
––! &
+=
––' )
OnItemClick
––* 5
;
––5 6
index
—— !
++
——! #
;
——# $
}
““ 
}
”” 
else
‘‘ 
{
’’ 
var
÷÷ %
tsMenuItemNoSuggestions
÷÷ 3
=
÷÷4 5
new
÷÷6 9
ToolStripMenuItem
÷÷: K
(
÷÷K L
$str
÷÷L `
)
÷÷` a
;
÷÷a b
ContextMenuStrip
◊◊ (
.
◊◊( )
Items
◊◊) .
.
◊◊. /
Insert
◊◊/ 5
(
◊◊5 6
index
◊◊6 ;
,
◊◊; <%
tsMenuItemNoSuggestions
◊◊= T
)
◊◊T U
;
◊◊U V%
tsMenuItemNoSuggestions
ÿÿ /
.
ÿÿ/ 0
Enabled
ÿÿ0 7
=
ÿÿ8 9
false
ÿÿ: ?
;
ÿÿ? @
index
ŸŸ 
++
ŸŸ 
;
ŸŸ  
}
⁄⁄ 
var
€€ 

separator1
€€ "
=
€€# $
new
€€% ( 
ToolStripSeparator
€€) ;
(
€€; <
)
€€< =
;
€€= >
ContextMenuStrip
‹‹ $
.
‹‹$ %
Items
‹‹% *
.
‹‹* +
Insert
‹‹+ 1
(
‹‹1 2
index
‹‹2 7
,
‹‹7 8

separator1
‹‹9 C
)
‹‹C D
;
‹‹D E
index
›› 
++
›› 
;
›› 
var
ﬂﬂ '
tsMenuItemAddToDictionary
ﬂﬂ 1
=
ﬂﬂ2 3
new
ﬂﬂ4 7
ToolStripMenuItem
ﬂﬂ8 I
(
ﬂﬂI J
$str
ﬂﬂJ a
,
ﬂﬂa b
null
ﬂﬂc g
,
ﬂﬂg h
OnAddToDictionary
ﬂﬂi z
)
ﬂﬂz {
;
ﬂﬂ{ |
ContextMenuStrip
‡‡ $
.
‡‡$ %
Items
‡‡% *
.
‡‡* +
Insert
‡‡+ 1
(
‡‡1 2
index
‡‡2 7
,
‡‡7 8'
tsMenuItemAddToDictionary
‡‡9 R
)
‡‡R S
;
‡‡S T
index
·· 
++
·· 
;
·· 
var
„„ 
tsMenuItemIgnore
„„ (
=
„„) *
new
„„+ .
ToolStripMenuItem
„„/ @
(
„„@ A
$str
„„A I
,
„„I J
null
„„K O
,
„„O P
OnIgnore
„„Q Y
)
„„Y Z
;
„„Z [
ContextMenuStrip
‰‰ $
.
‰‰$ %
Items
‰‰% *
.
‰‰* +
Insert
‰‰+ 1
(
‰‰1 2
index
‰‰2 7
,
‰‰7 8
tsMenuItemIgnore
‰‰9 I
)
‰‰I J
;
‰‰J K
index
ÂÂ 
++
ÂÂ 
;
ÂÂ 
var
ÁÁ 

separator2
ÁÁ "
=
ÁÁ# $
new
ÁÁ% ( 
ToolStripSeparator
ÁÁ) ;
(
ÁÁ; <
)
ÁÁ< =
;
ÁÁ= >
ContextMenuStrip
ËË $
.
ËË$ %
Items
ËË% *
.
ËË* +
Insert
ËË+ 1
(
ËË1 2
index
ËË2 7
,
ËË7 8

separator2
ËË9 C
)
ËËC D
;
ËËD E
}
ÈÈ "
AddStandardMenuItems
ÍÍ $
(
ÍÍ$ %
)
ÍÍ% &
;
ÍÍ& '
}
ÎÎ #
InitializeContextMenu
ÏÏ !
(
ÏÏ! "
)
ÏÏ" #
;
ÏÏ# $
}
ÌÌ 	
private
ÔÔ 
void
ÔÔ 
OnItemClick
ÔÔ  
(
ÔÔ  !
object
ÔÔ! '
sender
ÔÔ( .
,
ÔÔ. /
	EventArgs
ÔÔ0 9
e
ÔÔ: ;
)
ÔÔ; <
{
 	
var
ÒÒ 
selectedItem
ÒÒ 
=
ÒÒ 
sender
ÒÒ %
as
ÒÒ& (
ToolStripMenuItem
ÒÒ) :
;
ÒÒ: ;
misspelledWords
ÚÚ 
.
ÚÚ 
Remove
ÚÚ "
(
ÚÚ" #
wildcardWord
ÚÚ# /
)
ÚÚ/ 0
;
ÚÚ0 1
ranges
ÛÛ 
[
ÛÛ 
wildcardWord
ÛÛ 
]
ÛÛ  
.
ÛÛ  !
Text
ÛÛ! %
=
ÛÛ& '
selectedItem
ÛÛ( 4
.
ÛÛ4 5
Text
ÛÛ5 9
;
ÛÛ9 :
}
ÙÙ 	
private
ˆˆ 
void
ˆˆ 
OnAddToDictionary
ˆˆ &
(
ˆˆ& '
object
ˆˆ' -
sender
ˆˆ. 4
,
ˆˆ4 5
	EventArgs
ˆˆ6 ?
e
ˆˆ@ A
)
ˆˆA B
=>
ˆˆC E
spellChecker
ˆˆF R
.
ˆˆR S
Add
ˆˆS V
(
ˆˆV W
wildcardWord
ˆˆW c
)
ˆˆc d
;
ˆˆd e
private
¯¯ 
void
¯¯ 
OnIgnore
¯¯ 
(
¯¯ 
object
¯¯ $
sender
¯¯% +
,
¯¯+ ,
	EventArgs
¯¯- 6
e
¯¯7 8
)
¯¯8 9
=>
¯¯: <
spellChecker
¯¯= I
.
¯¯I J
Ignore
¯¯J P
(
¯¯P Q
wildcardWord
¯¯Q ]
)
¯¯] ^
;
¯¯^ _
private
˙˙ 
void
˙˙ "
AddStandardMenuItems
˙˙ )
(
˙˙) *
)
˙˙* +
{
˚˚ 	
ContextMenuStrip
¸¸ 
.
¸¸ 
Items
¸¸ "
.
¸¸" #
AddRange
¸¸# +
(
¸¸+ ,
new
¸¸, /
ToolStripItem
¸¸0 =
[
¸¸= >
]
¸¸> ?
{
˝˝ 
tsMenuItemCopy
˛˛ 
,
˛˛ 
tsMenuItemCut
˛˛  -
,
˛˛- .
tsMenuItemPaste
˛˛/ >
,
˛˛> ?
tsSeparator1
˛˛@ L
,
˛˛L M!
tsMenuItemSelectAll
˛˛N a
,
˛˛a b
tsMenuItemClear
ˇˇ 
,
ˇˇ  
tsSeparator2
ˇˇ! -
,
ˇˇ- .
tsMenuItemSearch
ˇˇ/ ?
,
ˇˇ? @!
tsMenuItemTranslate
ˇˇA T
,
ˇˇT U
}
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ #
InitializeContextMenu
ÉÉ *
(
ÉÉ* +
)
ÉÉ+ ,
{
ÑÑ 	
tsMenuItemCopy
ÖÖ 
.
ÖÖ 
Enabled
ÖÖ "
=
ÖÖ# $
SelectionLength
ÖÖ% 4
>
ÖÖ5 6
$num
ÖÖ7 8
;
ÖÖ8 9
tsMenuItemCut
ÜÜ 
.
ÜÜ 
Enabled
ÜÜ !
=
ÜÜ" #
!
ÜÜ$ %
ReadOnly
ÜÜ% -
&&
ÜÜ. 0
SelectionLength
ÜÜ1 @
>
ÜÜA B
$num
ÜÜC D
;
ÜÜD E
tsMenuItemPaste
áá 
.
áá 
Enabled
áá #
=
áá$ %
!
áá& '
ReadOnly
áá' /
;
áá/ 0!
tsMenuItemSelectAll
àà 
.
àà  
Enabled
àà  '
=
àà( )

TextLength
àà* 4
>
àà5 6
$num
àà7 8
&&
àà9 ;
SelectionLength
àà< K
<
ààL M

TextLength
ààN X
;
ààX Y
tsMenuItemClear
ââ 
.
ââ 
Enabled
ââ #
=
ââ$ %
!
ââ& '
ReadOnly
ââ' /
&&
ââ0 2

TextLength
ââ3 =
>
ââ> ?
$num
ââ@ A
;
ââA B
tsMenuItemSearch
ää 
.
ää 
Enabled
ää $
=
ää% &
SelectionLength
ää' 6
>
ää7 8
$num
ää9 :
;
ää: ;!
tsMenuItemTranslate
ãã 
.
ãã  
Enabled
ãã  '
=
ãã( )
SelectionLength
ãã* 9
>
ãã: ;
$num
ãã< =
;
ãã= >
}
åå 	
private
éé 
void
éé "
RaiseMenuItemsEvents
éé )
(
éé) *
)
éé* +
{
èè 	
tsMenuItemCopy
êê 
.
êê 
Click
êê  
+=
êê! #
(
êê$ %
s
êê% &
,
êê& '
e
êê( )
)
êê) *
=>
êê+ -
Copy
êê. 2
(
êê2 3
)
êê3 4
;
êê4 5
tsMenuItemCut
ëë 
.
ëë 
Click
ëë 
+=
ëë  "
(
ëë# $
s
ëë$ %
,
ëë% &
e
ëë' (
)
ëë( )
=>
ëë* ,
Cut
ëë- 0
(
ëë0 1
)
ëë1 2
;
ëë2 3
tsMenuItemPaste
íí 
.
íí 
Click
íí !
+=
íí" $
(
íí% &
s
íí& '
,
íí' (
e
íí) *
)
íí* +
=>
íí, .
Paste
íí/ 4
(
íí4 5
)
íí5 6
;
íí6 7!
tsMenuItemSelectAll
ìì 
.
ìì  
Click
ìì  %
+=
ìì& (
(
ìì) *
s
ìì* +
,
ìì+ ,
e
ìì- .
)
ìì. /
=>
ìì0 2
	SelectAll
ìì3 <
(
ìì< =
)
ìì= >
;
ìì> ?
tsMenuItemClear
îî 
.
îî 
Click
îî !
+=
îî" $
(
îî% &
s
îî& '
,
îî' (
e
îî) *
)
îî* +
=>
îî, .
Clear
îî/ 4
(
îî4 5
)
îî5 6
;
îî6 7
tsMenuItemSearch
ïï 
.
ïï 
Click
ïï "
+=
ïï# %
(
ïï& '
s
ïï' (
,
ïï( )
e
ïï* +
)
ïï+ ,
=>
ïï- /
Process
ïï0 7
.
ïï7 8
Start
ïï8 =
(
ïï= >
$"
ïï> @.
 https://www.google.com/search?q=
ïï@ `
{
ïï` a
SelectedText
ïïa m
}
ïïm n
"
ïïn o
)
ïïo p
;
ïïp q
tsMenuItemEnEs
ññ 
.
ññ 
Click
ññ  
+=
ññ! #
(
ññ$ %
s
ññ% &
,
ññ& '
e
ññ( )
)
ññ) *
=>
ññ+ -
Process
ññ. 5
.
ññ5 6
Start
ññ6 ;
(
ññ; <
$"
ññ< >Q
Bhttps://translate.google.com/?hl=es&op=translate&sl=en&tl=es&text=ññ> Ä
{ññÄ Å
SelectedTextññÅ ç
}ññç é
"ññé è
)ññè ê
;ññê ë
tsMenuItemEsEn
óó 
.
óó 
Click
óó  
+=
óó! #
(
óó$ %
s
óó% &
,
óó& '
e
óó( )
)
óó) *
=>
óó+ -
Process
óó. 5
.
óó5 6
Start
óó6 ;
(
óó; <
$"
óó< >Q
Bhttps://translate.google.com/?hl=es&op=translate&sl=es&tl=en&text=óó> Ä
{óóÄ Å
SelectedTextóóÅ ç
}óóç é
"óóé è
)óóè ê
;óóê ë
}
òò 	
private
öö 
string
öö !
GetWordFromPosition
öö *
(
öö* +
Point
öö+ 0
pt
öö1 3
)
öö3 4
{
õõ 	
var
úú 
currentIndex
úú 
=
úú &
GetCharIndexFromPosition
úú 7
(
úú7 8
pt
úú8 :
)
úú: ;
;
úú; <
int
ùù 

startIndex
ùù 
,
ùù 
endIndex
ùù $
;
ùù$ %
if
üü 
(
üü 
string
üü 
.
üü  
IsNullOrWhiteSpace
üü )
(
üü) *
Text
üü* .
)
üü. /
||
üü0 2
currentIndex
üü3 ?
<
üü@ A
$num
üüB C
)
üüC D
return
üüE K
string
üüL R
.
üüR S
Empty
üüS X
;
üüX Y
for
°° 
(
°° 

startIndex
°° 
=
°° 
currentIndex
°° *
;
°°* +

startIndex
°°, 6
>=
°°7 9
$num
°°: ;
;
°°; <

startIndex
°°= G
--
°°G I
)
°°I J
{
¢¢ 
if
££ 
(
££ 
char
££ 
.
££ 
IsWhiteSpace
££ %
(
££% &
Text
££& *
[
££* +

startIndex
££+ 5
]
££5 6
)
££6 7
)
££7 8
break
££9 >
;
££> ?
}
§§ 

startIndex
•• 
++
•• 
;
•• 
for
ßß 
(
ßß 
endIndex
ßß 
=
ßß 
currentIndex
ßß (
;
ßß( )
endIndex
ßß* 2
<
ßß3 4
Text
ßß5 9
.
ßß9 :
Length
ßß: @
;
ßß@ A
endIndex
ßßB J
++
ßßJ L
)
ßßL M
{
®® 
if
©© 
(
©© 
char
©© 
.
©© 
IsWhiteSpace
©© %
(
©©% &
Text
©©& *
[
©©* +
endIndex
©©+ 3
]
©©3 4
)
©©4 5
)
©©5 6
break
©©7 <
;
©©< =
}
™™ 
return
´´ 

startIndex
´´ 
>=
´´  
endIndex
´´! )
?
´´* +
string
´´, 2
.
´´2 3
Empty
´´3 8
:
´´9 :
Text
´´; ?
.
´´? @
	Substring
´´@ I
(
´´I J

startIndex
´´J T
,
´´T U
endIndex
´´V ^
-
´´_ `

startIndex
´´a k
)
´´k l
.
¨¨? @
TrimEnd
¨¨@ G
(
¨¨G H
new
¨¨H K
char
¨¨L P
[
¨¨P Q
]
¨¨Q R
{
¨¨S T
$char
¨¨U X
,
¨¨X Y
$char
¨¨Z ]
,
¨¨] ^
$char
¨¨_ b
,
¨¨b c
$char
¨¨d g
}
¨¨g h
)
¨¨h i
;
¨¨i j
}
≠≠ 	
private
ØØ 
string
ØØ 
CharRangeToString
ØØ (
(
ØØ( )
	CharRange
ØØ) 2
c
ØØ3 4
)
ØØ4 5
{
∞∞ 	
var
±± 
	textrange
±± 
=
±± 
new
±± 
PInvoke
±±  '
.
±±' (
	TextRange
±±( 1
{
±±2 3
chrg
±±4 8
=
±±9 :
c
±±; <
}
±±= >
;
±±> ?
if
≥≥ 
(
≥≥ 
c
≥≥ 
.
≥≥ 
cpMax
≥≥ 
-
≥≥ 
c
≥≥ 
.
≥≥ 
cpMin
≥≥ !
<=
≥≥" $
$num
≥≥% &
)
≥≥& '
{
¥¥ 
return
µµ 
string
µµ 
.
µµ 
Empty
µµ #
;
µµ# $
}
∂∂ 
int
∑∑ 

characters
∑∑ 
=
∑∑ 
(
∑∑ 
c
∑∑ 
.
∑∑  
cpMax
∑∑  %
-
∑∑& '
c
∑∑( )
.
∑∑) *
cpMin
∑∑* /
)
∑∑/ 0
+
∑∑1 2
$num
∑∑3 4
;
∑∑4 5
var
∏∏ 

charBuffer
∏∏ 
=
∏∏ 

CharBuffer
∏∏ '
.
∏∏' (
CreateBuffer
∏∏( 4
(
∏∏4 5

characters
∏∏5 ?
)
∏∏? @
;
∏∏@ A
IntPtr
ππ 
unmanagedBuffer
ππ "
=
ππ# $

charBuffer
ππ% /
.
ππ/ 0
AllocCoTaskMem
ππ0 >
(
ππ> ?
)
ππ? @
;
ππ@ A
if
ªª 
(
ªª 
unmanagedBuffer
ªª 
==
ªª  "
IntPtr
ªª# )
.
ªª) *
Zero
ªª* .
)
ªª. /
{
ºº 
throw
ΩΩ 
new
ΩΩ "
OutOfMemoryException
ΩΩ .
(
ΩΩ. /
)
ΩΩ/ 0
;
ΩΩ0 1
}
ææ 
	textrange
øø 
.
øø 
	lpstrText
øø 
=
øø  !
unmanagedBuffer
øø" 1
;
øø1 2
NativeMethods
¿¿ 
.
¿¿ 
SendMessage
¿¿ %
(
¿¿% &
Handle
¿¿& ,
,
¿¿, -
RichEditMessages
¿¿. >
.
¿¿> ?
EM_GETTEXTRANGE
¿¿? N
,
¿¿N O
IntPtr
¿¿P V
.
¿¿V W
Zero
¿¿W [
,
¿¿[ \
ref
¿¿] `
	textrange
¿¿a j
)
¿¿j k
;
¿¿k l

charBuffer
¡¡ 
.
¡¡ 
PutCoTaskMem
¡¡ #
(
¡¡# $
unmanagedBuffer
¡¡$ 3
)
¡¡3 4
;
¡¡4 5
if
√√ 
(
√√ 
	textrange
√√ 
.
√√ 
	lpstrText
√√ #
!=
√√$ &
IntPtr
√√' -
.
√√- .
Zero
√√. 2
)
√√2 3
{
ƒƒ 
Marshal
≈≈ 
.
≈≈ 
FreeCoTaskMem
≈≈ %
(
≈≈% &
unmanagedBuffer
≈≈& 5
)
≈≈5 6
;
≈≈6 7
}
∆∆ 
return
«« 

charBuffer
«« 
.
«« 
	GetString
«« '
(
««' (
)
««( )
;
««) *
}
»» 	
int
ŒŒ 
IRichEditBox
ŒŒ 
.
ŒŒ 
BackgroundColor
ŒŒ (
{
œœ 	
get
–– 
=>
–– 
ColorTranslator
–– "
.
––" #
ToWin32
––# *
(
––* +
	BackColor
––+ 4
)
––4 5
;
––5 6
set
—— 
=>
—— 
	BackColor
—— 
=
—— 
ColorTranslator
—— .
.
——. /
	FromWin32
——/ 8
(
——8 9
value
——9 >
)
——> ?
;
——? @
}
““ 	
int
‘‘ 
IRichEditBox
‘‘ 
.
‘‘ 
ContentLength
‘‘ &
{
’’ 	
get
÷÷ 
=>
÷÷ 
SelectionLength
÷÷ "
;
÷÷" #
set
◊◊ 
=>
◊◊ 
SelectionLength
◊◊ "
=
◊◊# $
value
◊◊% *
;
◊◊* +
}
ÿÿ 	
int
⁄⁄ 
IRichEditBox
⁄⁄ 
.
⁄⁄ 
ContentStart
⁄⁄ %
{
€€ 	
get
‹‹ 
=>
‹‹ 
SelectionStart
‹‹ !
;
‹‹! "
set
›› 
=>
›› 
SelectionStart
›› !
=
››" #
value
››$ )
;
››) *
}
ﬁﬁ 	
void
‡‡ 
IRichEditBox
‡‡ 
.
‡‡ 
InsertImage
‡‡ %
(
‡‡% &
string
‡‡& ,
filename
‡‡- 5
)
‡‡5 6
=>
‡‡7 9
InsertImage
‡‡: E
(
‡‡E F
$num
‡‡F G
,
‡‡G H(
VerticalCharacterAlignment
‡‡I c
.
‡‡c d
Baseline
‡‡d l
,
‡‡l m
filename
‡‡n v
)
‡‡v w
;
‡‡w x
void
‚‚ 
IRichEditBox
‚‚ 
.
‚‚ 
InsertTable
‚‚ %
(
‚‚% &
int
‚‚& )

numColumns
‚‚* 4
,
‚‚4 5
int
‚‚6 9
numRows
‚‚: A
)
‚‚A B
=>
‚‚C E
InsertTable
‚‚F Q
(
‚‚Q R

numColumns
‚‚R \
,
‚‚\ ]
numRows
‚‚^ e
,
‚‚e f
Color
‚‚g l
.
‚‚l m
Black
‚‚m r
,
‚‚r s
Color
‚‚t y
.
‚‚y z
White
‚‚z 
,‚‚ Ä
Color‚‚Å Ü
.‚‚Ü á
Black‚‚á å
)‚‚å ç
;‚‚ç é
}
ÂÂ 
}ÊÊ Í
]D:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\UIElement\RichEditPrintDocument.cs
	namespace 	"
EzWriterCustomControls
  
.  !
	UIElement! *
{ 
public 

partial 
class !
RichEditPrintDocument .
:/ 0
PrintDocument1 >
,> ?"
IRichEditPrintDocument@ V
{ 
private		 
int		 
firstCharOnPage		 #
;		# $
private

 
RichEditBox

 
richEdit

 $
;

$ %
public !
RichEditPrintDocument $
($ %
)% &
=>' )
InitializeComponent* =
(= >
)> ?
;? @
public !
RichEditPrintDocument $
($ %

IContainer% /
	container0 9
)9 :
{ 	
	container 
. 
Add 
( 
this 
) 
;  
InitializeComponent 
(  
)  !
;! "
} 	
public !
RichEditPrintDocument $
($ %
RichEditBox% 0
richEdit1 9
)9 :
:; <
this= A
(A B
)B C
=>D F
thisG K
.K L
richEditL T
=U V
richEditW _
;_ `
	protected 
override 
void 
OnBeginPrint  ,
(, -
PrintEventArgs- ;
e< =
)= >
{ 	
base 
. 
OnBeginPrint 
( 
e 
)  
;  !
firstCharOnPage 
= 
$num 
;  
} 	
	protected 
override 
void 

OnEndPrint  *
(* +
PrintEventArgs+ 9
e: ;
); <
{ 	
base 
. 

OnEndPrint 
( 
e 
) 
; 
richEdit 
. 
FormatRangeDone $
($ %
)% &
;& '
}   	
	protected"" 
override"" 
void"" 
OnPrintPage""  +
(""+ ,
PrintPageEventArgs"", >
e""? @
)""@ A
{## 	
base$$ 
.$$ 
OnPrintPage$$ 
($$ 
e$$ 
)$$ 
;$$  
firstCharOnPage%% 
=%% 
richEdit%% &
.%%& '
FormatRange%%' 2
(%%2 3
e%%3 4
,%%4 5
firstCharOnPage%%6 E
,%%E F
richEdit%%G O
.%%O P

TextLength%%P Z
)%%Z [
;%%[ \
e&& 
.&& 
HasMorePages&& 
=&& 
firstCharOnPage&& ,
<&&- .
richEdit&&/ 7
.&&7 8

TextLength&&8 B
;&&B C
}'' 	
}(( 
})) ¶
XD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\Util\ImageExtensionMethods.cs
	namespace 	"
EzWriterCustomControls
  
.  !
Util! %
{ 
static

 

class

 !
ImageExtensionMethods

 &
{ 
public 
static 
int 
HiMetricWidth '
(' (
this( ,
Image- 2
image3 8
)8 9
{ 	
int 
dpi 
= 
default 
; 
var 
name 
= 
$str =
;= >
using 
( 
var 
key 
= 
Registry %
.% &
CurrentUser& 1
.1 2

OpenSubKey2 <
(< =
name= A
)A B
)B C
{ 
if 
( 
key 
!= 
null 
)  
{ 
object 
o 
= 
key "
." #
GetValue# +
(+ ,
$str, 8
)8 9
;9 :
dpi 
= 
Convert !
.! "
ToInt32" )
() *
o* +
)+ ,
;, -
}   
}!! 
return"" 
image"" 
."" 
Width"" 
*""  
(""! "
$num""" &
/""' (
dpi"") ,
)"", -
;""- .
}## 	
public++ 
static++ 
int++ 
HiMetricHeight++ (
(++( )
this++) -
Image++. 3
image++4 9
)++9 :
{,, 	
int-- 
dpi-- 
=-- 
default-- 
;-- 
var.. 
name.. 
=.. 
$str.. =
;..= >
using00 
(00 
var00 
key00 
=00 
Registry00 %
.00% &
CurrentUser00& 1
.001 2

OpenSubKey002 <
(00< =
name00= A
)00A B
)00B C
{11 
if22 
(22 
key22 
!=22 
null22 
)22  
{33 
object44 
o44 
=44 
key44 "
.44" #
GetValue44# +
(44+ ,
$str44, 8
)448 9
;449 :
dpi55 
=55 
Convert55 !
.55! "
ToInt3255" )
(55) *
o55* +
)55+ ,
;55, -
}66 
}77 
return88 
image88 
.88 
Height88 
*88  !
(88" #
$num88# '
/88( )
dpi88* -
)88- .
;88. /
}99 	
}:: 
};; ª"
aD:\Programacion\CSharp\WPF\EzWriter\EzWriterCustomControls\Util\FluentContextMenuStripRenderer.cs
	namespace 	"
EzWriterCustomControls
  
.  !
Util! %
{ 
class

 	*
FluentContextMenuStripRenderer


 (
:

) *)
ToolStripProfessionalRenderer

+ H
{ 
public *
FluentContextMenuStripRenderer -
(- .
). /
:0 1
base2 6
(6 7
new7 :,
 FluentContextMenuStripColorTable; [
([ \
)\ ]
)] ^
{_ `
}a b
	protected 
override 
void 
OnRenderArrow  -
(- .)
ToolStripArrowRenderEventArgs. K
eL M
)M N
{ 	
var 
g 
= 
e 
. 
Graphics 
; 
var 
oldMode 
= 
g 
. 
Save  
(  !
)! "
;" #
g 
. 
SmoothingMode 
= 
SmoothingMode +
.+ ,
	AntiAlias, 5
;5 6
var 
rect 
= 
new 
	Rectangle $
($ %
e% &
.& '
ArrowRectangle' 5
.5 6
Location6 >
,> ?
e@ A
.A B
ArrowRectangleB P
.P Q
SizeQ U
)U V
;V W
rect 
. 
Inflate 
( 
- 
$num 
, 
- 
$num 
)  
;  !
using 
( 
var 
pen 
= 
new  
Pen! $
($ %
Color% *
.* +
Black+ 0
)0 1
)1 2
{ 
g 
. 
	DrawLines 
( 
pen 
,  
new! $
Point% *
[* +
]+ ,
{   
new!! 
Point!! 
(!! 
rect!! "
.!!" #
Left!!# '
,!!' (
rect!!) -
.!!- .
Top!!. 1
)!!1 2
,!!2 3
new"" 
Point"" 
("" 
rect"" "
.""" #
Right""# (
,""( )
rect""* .
."". /
Top""/ 2
+""3 4
rect""5 9
.""9 :
Height"": @
/""A B
$num""C D
)""D E
,""E F
new## 
Point## 
(## 
rect## "
.##" #
Left### '
,##' (
rect##) -
.##- .
Top##. 1
+##2 3
rect##4 8
.##8 9
Height##9 ?
)##? @
}$$ 
)$$ 
;$$ 
}%% 
g&& 
.&& 
Restore&& 
(&& 
oldMode&& 
)&& 
;&& 
}'' 	
private,, 
class,, ,
 FluentContextMenuStripColorTable,, 6
:,,7 8"
ProfessionalColorTable,,9 O
{-- 	
public.. 
override.. 
Color.. !
MenuItemBorder.." 0
=>..1 3
SystemColors..4 @
...@ A!
GradientActiveCaption..A V
;..V W
public00 
override00 
Color00 !
MenuItemSelected00" 2
=>003 5
SystemColors006 B
.00B C!
GradientActiveCaption00C X
;00X Y
public22 
override22 
Color22 !'
ToolStripDropDownBackground22" =
=>22> @
Color22A F
.22F G
White22G L
;22L M
public44 
override44 
Color44 !$
ImageMarginGradientBegin44" :
=>44; =
Color44> C
.44C D
White44D I
;44I J
public66 
override66 
Color66 !%
ImageMarginGradientMiddle66" ;
=>66< >
Color66? D
.66D E
White66E J
;66J K
public88 
override88 
Color88 !"
ImageMarginGradientEnd88" 8
=>889 ;
Color88< A
.88A B
White88B G
;88G H
}99 	
}:: 
};; 